# ğŸ” CryptoVault Enterprise

> **Military-Grade Cloud Security with 7 Layers of Encryption**
>
> A comprehensive, quantum-ready secure file storage system implementing zero-knowledge architecture with cutting-edge cryptographic protocols.

[![Next.js](https://img.shields.io/badge/Next.js-15.0-black?logo=next.js)](https://nextjs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.3-blue?logo=typescript)](https://www.typescriptlang.org/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-Prisma-336791?logo=postgresql)](https://www.prisma.io/)
[![AWS](https://img.shields.io/badge/AWS-S3%20%2B%20KMS-FF9900?logo=amazon-aws)](https://aws.amazon.com/)

---

## ğŸ“‹ Table of Contents

- [Overview](#-overview)
- [Key Features](#-key-features)
- [What Makes This Project Unique](#-what-makes-this-project-unique)
- [System Architecture](#-system-architecture)
- [Cryptographic Modules](#-cryptographic-modules)
- [7 Layers of Security](#-7-layers-of-security)
- [Encryption Flow Diagrams](#-encryption-flow-diagrams)
- [Technology Stack](#-technology-stack)
- [Database Schema](#-database-schema)
- [API Endpoints](#-api-endpoints)
- [Project Structure](#-project-structure)
- [Getting Started](#-getting-started)
- [Configuration](#-configuration)
- [Demo Mode](#-demo-mode)
- [Future Roadmap](#-future-roadmap)

---

## ğŸ¯ Overview

**CryptoVault Enterprise** is a production-ready, enterprise-grade secure file storage platform that implements **zero-knowledge encryption**. Unlike traditional cloud storage providers, CryptoVault ensures that:

- **Your files are encrypted client-side** before they ever leave your browser
- **The server never sees your plaintext data** or encryption keys
- **Even we cannot decrypt your files** - only you hold the keys
- **Future quantum attacks are mitigated** with post-quantum cryptography readiness

This project demonstrates advanced cryptographic concepts including:
- **Envelope Encryption** (AES-256-GCM + RSA-4096 OAEP)
- **Post-Quantum Cryptography** (CRYSTALS-Kyber simulation)
- **Zero-Knowledge Proofs** (Schnorr Protocol)
- **Multi-Party Computation** (Shamir's Secret Sharing)
- **Attribute-Based Encryption** (CP-ABE for access control)
- **Oblivious RAM** (Path ORAM for access pattern hiding)
- **Quantum Key Distribution** (BB84 protocol simulation)

---

## âœ¨ Key Features

### ğŸ”’ Security Features
| Feature | Description |
|---------|-------------|
| **Client-Side Encryption** | Files encrypted in browser before upload using AES-256-GCM |
| **Envelope Encryption** | DEK wrapped with RSA-4096 OAEP public key |
| **Zero-Knowledge Architecture** | Server never sees plaintext or user keys |
| **Multi-Cloud Redundancy** | AWS S3 + GCP Storage support |
| **AWS KMS Integration** | Additional server-side key wrapping |
| **HMAC Integrity** | SHA-512 HMAC for tamper detection |
| **Merkle Trees** | Chunk-level integrity verification |
| **Blockchain Audit Trail** | Cryptographically chained, ECDSA-signed logs |

### ğŸš€ Advanced Cryptography
| Module | Algorithm | Purpose |
|--------|-----------|---------|
| Post-Quantum | CRYSTALS-Kyber | Future-proof key encapsulation |
| QKD | BB84 Protocol | Quantum key distribution simulation |
| ZKP | Schnorr Protocol | Zero-knowledge authentication |
| MPC | Shamir's Secret Sharing | Threshold key recovery |
| ABE | CP-ABE | Policy-based access control |
| FHE | BFV/CKKS (SEAL) | Searchable encryption simulation |
| ORAM | Path ORAM | Access pattern hiding |
| PRE | AFGH Scheme | Secure file sharing |

### ğŸ›¡ï¸ Enterprise Features
- **X.509 PKI** - Full certificate chain management
- **Kerberos-Style Authentication** - Ticket-based service access
- **ECDSA P-384 Signatures** - Digital signature verification
- **PBKDF2 Key Derivation** - Secure password-based keys
- **Real-time Analytics** - Encryption performance metrics

---

## ğŸŒŸ What Makes This Project Unique

### Novelty Compared to Regular File Storage

| Aspect | Traditional Cloud Storage | CryptoVault Enterprise |
|--------|--------------------------|------------------------|
| **Encryption Location** | Server-side (provider has keys) | Client-side (only you have keys) |
| **Key Management** | Provider-controlled | User-controlled with envelope encryption |
| **Data Access** | Provider can read your files | Zero-knowledge: we CAN'T read your files |
| **Quantum Safety** | Vulnerable to future quantum attacks | Kyber PQC + hybrid encryption ready |
| **Audit Trail** | Mutable logs | Immutable blockchain-style chain |
| **Access Control** | Simple permissions | Policy-based (Attribute-Based Encryption) |
| **Sharing Model** | Share link = share plaintext | Proxy Re-encryption (never expose original key) |
| **Access Patterns** | Visible to provider | Hidden with ORAM techniques |

### ğŸ“ Educational & Research Value

This project implements **20+ cryptographic algorithms** in a real-world application context:

1. **Symmetric Encryption**: AES-256-GCM, ChaCha20-Poly1305
2. **Asymmetric Encryption**: RSA-4096-OAEP, ElGamal
3. **Key Exchange**: Diffie-Hellman (RFC 3526), ECDH (P-384)
4. **Digital Signatures**: ECDSA P-384, EdDSA (Ed25519)
5. **Hashing**: SHA-256, SHA-512, SHA-3
6. **Key Derivation**: PBKDF2, HKDF
7. **Post-Quantum**: CRYSTALS-Kyber (lattice-based)
8. **Zero-Knowledge**: Schnorr Identification Protocol
9. **Secret Sharing**: Shamir's (t,n)-threshold scheme
10. **Attribute-Based**: CP-ABE policy expressions

---

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              CRYPTOVAULT ENTERPRISE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Client-Side   â”‚    â”‚    Server-Side   â”‚    â”‚   Cloud Storage  â”‚         â”‚
â”‚  â”‚   (Browser)     â”‚â”€â”€â”€â–¶â”‚    (Next.js)     â”‚â”€â”€â”€â–¶â”‚   (AWS/GCP)      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                      â”‚                       â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ AES-256-GCM     â”‚    â”‚ Authentication  â”‚    â”‚ S3 Bucket       â”‚         â”‚
â”‚  â”‚ Encryption      â”‚    â”‚ JWT + Cookies   â”‚    â”‚ (Encrypted)     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                      â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ RSA-4096 OAEP   â”‚    â”‚ Prisma ORM      â”‚    â”‚ AWS KMS         â”‚         â”‚
â”‚  â”‚ Key Wrapping    â”‚    â”‚ PostgreSQL      â”‚    â”‚ (Key Wrapping)  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### High-Level Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User    â”‚â”€â”€â”€â”€â–¶â”‚ Generate DEK  â”‚â”€â”€â”€â”€â–¶â”‚ Encrypt File â”‚â”€â”€â”€â”€â–¶â”‚ Wrap DEK    â”‚
â”‚  File    â”‚     â”‚ (AES-256)     â”‚     â”‚ (AES-256-GCM)â”‚     â”‚ (RSA-4096)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                         Upload to Server                              â”‚
     â”‚  â€¢ Encrypted file data (ciphertext)                                   â”‚
     â”‚  â€¢ Wrapped DEK (RSA-encrypted)                                        â”‚
     â”‚  â€¢ IV, Auth Tag, HMAC signature                                       â”‚
     â”‚  â€¢ Metadata (encrypted filename, size)                                â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   PostgreSQL     â”‚     â”‚    AWS S3        â”‚     â”‚    AWS KMS       â”‚
     â”‚   (Metadata)     â”‚     â”‚   (Ciphertext)   â”‚     â”‚   (DEK Wrap)     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Cryptographic Modules

### Module Overview

```
lib/crypto/
â”œâ”€â”€ aes.ts                    # AES-256-GCM encryption/decryption
â”œâ”€â”€ rsa.ts                    # RSA-4096-OAEP key wrapping
â”œâ”€â”€ envelope-encryption.ts    # Combined AES+RSA envelope pattern
â”œâ”€â”€ ecdsa.ts                  # ECDSA P-384 digital signatures
â”œâ”€â”€ ecdh.ts                   # Elliptic Curve Diffie-Hellman
â”œâ”€â”€ eddsa.ts                  # EdDSA Ed25519 signatures
â”œâ”€â”€ diffie-hellman.ts         # Classic DH key exchange (RFC 3526)
â”œâ”€â”€ elgamal.ts                # ElGamal encryption
â”œâ”€â”€ sha.ts                    # SHA-256/512 hashing
â”œâ”€â”€ hmac.ts                   # HMAC-SHA512 integrity
â”œâ”€â”€ hashing.ts                # Merkle trees, hash comparison
â”œâ”€â”€ number-theory.ts          # Modular arithmetic primitives
â”œâ”€â”€ pgp.ts                    # PGP-style message encryption
â”œâ”€â”€ tls.ts                    # TLS handshake simulation
â”œâ”€â”€ x509.ts                   # X.509 PKI certificates
â”œâ”€â”€ kerberos.ts               # Kerberos ticket system
â”œâ”€â”€ symmetric-ciphers.ts      # Additional symmetric modes
â”‚
â”œâ”€â”€ post-quantum/
â”‚   â”œâ”€â”€ kyber.ts              # CRYSTALS-Kyber (lattice-based)
â”‚   â””â”€â”€ qkd.ts                # BB84 quantum key distribution
â”‚
â”œâ”€â”€ zkp/
â”‚   â””â”€â”€ schnorr.ts            # Schnorr zero-knowledge protocol
â”‚
â”œâ”€â”€ mpc/
â”‚   â””â”€â”€ shamir.ts             # Shamir's secret sharing
â”‚
â”œâ”€â”€ abe/
â”‚   â””â”€â”€ cp-abe.ts             # Ciphertext-Policy ABE
â”‚
â”œâ”€â”€ fhe/
â”‚   â””â”€â”€ seal-wrapper.ts       # Microsoft SEAL FHE wrapper
â”‚
â”œâ”€â”€ oram/
â”‚   â””â”€â”€ path-oram.ts          # Path ORAM implementation
â”‚
â””â”€â”€ proxy-re-encryption/
    â””â”€â”€ afgh.ts               # AFGH proxy re-encryption
```

---

## ğŸ›¡ï¸ 7 Layers of Security

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        LAYER 7: Audit Trail                         â”‚
â”‚           Blockchain-style logs with ECDSA signatures               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      LAYER 6: Access Control                        â”‚
â”‚         Attribute-Based Encryption (CP-ABE) policies                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    LAYER 5: Cloud KMS Wrapping                      â”‚
â”‚              AWS KMS additional key encryption                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  LAYER 4: Multi-Cloud Storage                       â”‚
â”‚            AWS S3 + GCP Cloud Storage redundancy                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   LAYER 3: HMAC Integrity                           â”‚
â”‚              HMAC-SHA512 tamper detection                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                LAYER 2: RSA-4096-OAEP Key Wrap                      â”‚
â”‚          Asymmetric encryption of Data Encryption Key               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              LAYER 1: AES-256-GCM Encryption                        â”‚
â”‚        Client-side symmetric encryption of file data                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Detailed Layer Breakdown

| Layer | Component | Algorithm | Purpose |
|-------|-----------|-----------|---------|
| 1 | **Data Encryption** | AES-256-GCM | Encrypts file with 256-bit key + 128-bit auth tag |
| 2 | **Key Wrapping** | RSA-4096-OAEP | Wraps DEK with user's 4096-bit public key |
| 3 | **Integrity** | HMAC-SHA512 | Detects any tampering with ciphertext |
| 4 | **Storage** | Multi-Cloud | Distributed across AWS S3 + GCP for redundancy |
| 5 | **Server KMS** | AWS KMS | Additional key envelope protection |
| 6 | **Access Control** | CP-ABE | Policy-based decryption permissions |
| 7 | **Audit** | ECDSA + Hash Chain | Immutable, signed activity logs |

---

## ğŸ“Š Encryption Flow Diagrams

### File Upload Encryption Flow

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  User File  â”‚
                    â”‚  (Plaintext)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚      Generate Random DEK         â”‚
          â”‚       (AES-256, 256 bits)        â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚    Generate Random IV (12 bytes) â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚       AES-256-GCM Encrypt        â”‚
          â”‚   Input: File + DEK + IV         â”‚
          â”‚   Output: Ciphertext + AuthTag   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚        Generate HMAC            â”‚
          â”‚     HMAC-SHA512(ciphertext)     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚        RSA-4096-OAEP            â”‚
          â”‚    Encrypt DEK with Public Key  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚      Optional: AWS KMS           â”‚
          â”‚    Wrap encrypted DEK again      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              STORED TO CLOUD                     â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
    â”‚  â”‚    S3       â”‚  â”‚  PostgreSQL â”‚              â”‚
    â”‚  â”‚ (Ciphertext)â”‚  â”‚ (Metadata)  â”‚              â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### File Download Decryption Flow

```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚            RETRIEVE FROM CLOUD                   â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
    â”‚  â”‚    S3       â”‚  â”‚  PostgreSQL â”‚              â”‚
    â”‚  â”‚ (Ciphertext)â”‚  â”‚ (Metadata)  â”‚              â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                â”‚
              â”‚                â”‚
              â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Retrieve: Ciphertext, IV,        â”‚
    â”‚    AuthTag, Wrapped DEK, HMAC       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Verify HMAC Signature     â”‚
         â”‚  (Detect any tampering)     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   RSA-4096-OAEP Decrypt     â”‚
         â”‚  Unwrap DEK with Private Keyâ”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚     AES-256-GCM Decrypt     â”‚
         â”‚  Decrypt ciphertext + verifyâ”‚
         â”‚  authentication tag         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Plaintext    â”‚
              â”‚  File Data    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Envelope Encryption Pattern

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ENVELOPE ENCRYPTION                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚    â”‚   Plaintext  â”‚                                                    â”‚
â”‚    â”‚    Data      â”‚                                                    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚           â”‚                                                            â”‚
â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚           â”‚  â”‚  Data Encryption    â”‚                                   â”‚
â”‚           â”‚  â”‚  Key (DEK)          â”‚â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚           â”‚  â”‚  AES-256, random    â”‚      â”‚                            â”‚
â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                            â”‚
â”‚           â”‚             â”‚                 â”‚                            â”‚
â”‚           â–¼             â”‚                 â–¼                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    â”‚  AES-256-GCM â”‚     â”‚     â”‚  RSA-4096-OAEP    â”‚                   â”‚
â”‚    â”‚  Encrypt     â”‚     â”‚     â”‚  Key Wrap          â”‚                   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚           â”‚             â”‚               â”‚                              â”‚
â”‚           â”‚             â”‚               â”‚                              â”‚
â”‚           â–¼             â”‚               â–¼                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    â”‚  Ciphertext  â”‚     â”‚     â”‚   Wrapped DEK      â”‚                   â”‚
â”‚    â”‚  (large)     â”‚     â”‚     â”‚   (512 bytes)      â”‚                   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                         â”‚                                              â”‚
â”‚    WHY? AES is fast    â”‚    WHY? RSA can only encrypt                â”‚
â”‚    for large data      â”‚    ~470 bytes (4096-bit key)                 â”‚
â”‚                        â”‚    Perfect for small DEKs (32 bytes)         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Zero-Knowledge Proof (Schnorr Protocol)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SCHNORR ZERO-KNOWLEDGE PROTOCOL                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚     PROVER (Alice)                        VERIFIER (Bob)                â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚                                                                         â”‚
â”‚     Has: Private key x                    Has: Public key y = g^x       â”‚
â”‚     Wants to prove: "I know x"            Wants to verify: Knowledge    â”‚
â”‚     Without revealing: x                                                â”‚
â”‚                                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚ Step 1: COMMITMENT                                          â”‚    â”‚
â”‚     â”‚ Alice picks random r, computes v = g^r                      â”‚    â”‚
â”‚     â”‚                                                             â”‚    â”‚
â”‚     â”‚         Alice â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ v â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Bob             â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚ Step 2: CHALLENGE                                           â”‚    â”‚
â”‚     â”‚ Bob picks random challenge c = H(v || y || context)         â”‚    â”‚
â”‚     â”‚                                                             â”‚    â”‚
â”‚     â”‚         Alice â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ c â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Bob              â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚ Step 3: RESPONSE                                            â”‚    â”‚
â”‚     â”‚ Alice computes s = r + c*x (mod n)                          â”‚    â”‚
â”‚     â”‚                                                             â”‚    â”‚
â”‚     â”‚         Alice â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ s â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Bob             â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚ Step 4: VERIFICATION                                        â”‚    â”‚
â”‚     â”‚ Bob checks: g^s == v * y^c                                  â”‚    â”‚
â”‚     â”‚                                                             â”‚    â”‚
â”‚     â”‚ âœ… Valid: Alice knows x (99.999...% certainty)              â”‚    â”‚
â”‚     â”‚ âŒ Invalid: Alice doesn't know x                            â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Shamir's Secret Sharing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SHAMIR'S SECRET SHARING (3-of-5)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚                         SECRET = S                                      â”‚
â”‚                                                                         â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚          â”‚   Random Polynomial: f(x) = S + ax + bxÂ²â”‚                   â”‚
â”‚          â”‚   Degree = threshold - 1 = 2            â”‚                   â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                         â”‚
â”‚              SPLIT INTO 5 SHARES                                        â”‚
â”‚                                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚     â”‚Share 1â”‚  â”‚Share 2â”‚  â”‚Share 3â”‚  â”‚Share 4â”‚  â”‚Share 5â”‚             â”‚
â”‚     â”‚ (1,yâ‚)â”‚  â”‚ (2,yâ‚‚)â”‚  â”‚ (3,yâ‚ƒ)â”‚  â”‚ (4,yâ‚„)â”‚  â”‚ (5,yâ‚…)â”‚             â”‚
â”‚     â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜             â”‚
â”‚         â”‚          â”‚          â”‚          â”‚          â”‚                  â”‚
â”‚         â–¼          â–¼          â–¼          â–¼          â–¼                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚     â”‚  AWS  â”‚  â”‚  GCP  â”‚  â”‚ User  â”‚  â”‚Backup â”‚  â”‚Backup â”‚             â”‚
â”‚     â”‚  KMS  â”‚  â”‚  KMS  â”‚  â”‚Device â”‚  â”‚  #1   â”‚  â”‚  #2   â”‚             â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                         â”‚
â”‚              RECONSTRUCT WITH ANY 3 SHARES                              â”‚
â”‚                                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚     â”‚Share 1 â”‚  â”‚Share 3 â”‚  â”‚Share 4 â”‚                                 â”‚
â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                                 â”‚
â”‚          â”‚           â”‚           â”‚                                      â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                    â”‚                                                    â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚          â”‚ Lagrange          â”‚                                          â”‚
â”‚          â”‚ Interpolation     â”‚                                          â”‚
â”‚          â”‚ at x = 0          â”‚                                          â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                    â”‚                                                    â”‚
â”‚                    â–¼                                                    â”‚
â”‚               SECRET = S                                                â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### BB84 Quantum Key Distribution

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BB84 QUANTUM KEY DISTRIBUTION                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚     ALICE                                            BOB                â”‚
â”‚     â”€â”€â”€â”€â”€                                            â”€â”€â”€                â”‚
â”‚                                                                         â”‚
â”‚  1. Generate random bits:        1 0 1 1 0 1 0 0                       â”‚
â”‚  2. Choose random bases:         + Ã— + Ã— Ã— + + Ã—                       â”‚
â”‚  3. Encode qubits:              |â†‘âŸ©|â†—âŸ©|â†‘âŸ©|â†˜âŸ©|â†—âŸ©|â†“âŸ©|â†’âŸ©|â†—âŸ©              â”‚
â”‚                                                                         â”‚
â”‚                     â•â•â•â•â•â•â•â• QUANTUM CHANNEL â•â•â•â•â•â•â•â•                  â”‚
â”‚                           (qubits transmitted)                         â”‚
â”‚                                                                         â”‚
â”‚                                          4. Choose random bases:        â”‚
â”‚                                             + Ã— Ã— + Ã— + + +            â”‚
â”‚                                          5. Measure qubits              â”‚
â”‚                                                                         â”‚
â”‚                     â•â•â•â•â•â•â•â• CLASSICAL CHANNEL â•â•â•â•â•â•â•â•                â”‚
â”‚                           (bases comparison)                           â”‚
â”‚                                                                         â”‚
â”‚  6. Compare bases publicly:      + Ã— + Ã— Ã— + + Ã—  (Alice)              â”‚
â”‚                                  + Ã— Ã— + Ã— + + +  (Bob)                â”‚
â”‚                                  â”€ â”€ âœ— âœ— â”€ â”€ â”€ âœ—  (Match?)             â”‚
â”‚                                                                         â”‚
â”‚  7. Keep matching positions:     1   -  -  1 0                         â”‚
â”‚                                                                         â”‚
â”‚  8. Sifted Key (both):           1 1 0                                 â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ EAVESDROPPER DETECTION:                                         â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚ If Eve intercepts and measures:                                 â”‚   â”‚
â”‚  â”‚   â€¢ She disturbs quantum states (no-cloning theorem)            â”‚   â”‚
â”‚  â”‚   â€¢ Introduces ~25% error rate in sifted key                    â”‚   â”‚
â”‚  â”‚   â€¢ Alice and Bob detect by comparing sample bits               â”‚   â”‚
â”‚  â”‚   â€¢ Error rate > 11%  â†’  Abort key exchange!                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» Technology Stack

### Frontend
| Technology | Version | Purpose |
|------------|---------|---------|
| **Next.js** | 15.0 | React framework with App Router |
| **React** | 18.3 | UI component library |
| **TypeScript** | 5.3 | Type-safe JavaScript |
| **Tailwind CSS** | 3.4 | Utility-first styling |
| **Framer Motion** | 10.16 | Animations |
| **Lucide React** | 0.294 | Icon library |
| **Recharts** | 2.10 | Analytics charts |
| **Zustand** | 4.4 | State management |

### Backend
| Technology | Version | Purpose |
|------------|---------|---------|
| **Next.js API Routes** | 15.0 | Serverless API endpoints |
| **Prisma** | 5.7 | Type-safe ORM |
| **PostgreSQL** | Latest | Relational database |
| **jose** | 5.1 | JWT authentication |
| **bcryptjs** | 2.4 | Password hashing |

### Cryptography
| Library | Purpose |
|---------|---------|
| **Web Crypto API** | Native browser cryptography |
| **@noble/curves** | Elliptic curve operations (secp256k1) |
| **@noble/hashes** | High-performance hashing |

### Cloud Services
| Service | Purpose |
|---------|---------|
| **AWS S3** | Primary file storage |
| **AWS KMS** | Key Management Service |
| **GCP Cloud Storage** | Backup storage (optional) |
| **GCP Cloud KMS** | Backup key management (optional) |

---

## ğŸ—„ï¸ Database Schema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            DATABASE SCHEMA                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 USERS                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                    String     @id @default(cuid())                   â”‚
â”‚ email                 String     @unique                                â”‚
â”‚ passwordHash          String                                            â”‚
â”‚ publicKey             String?    RSA-4096 public key (PEM)             â”‚
â”‚ privateKeyEncrypted   String?    AES-encrypted private key             â”‚
â”‚ ecdsaPublicKey        String?    ECDSA P-384 for signatures            â”‚
â”‚ zkpPublicKey          String?    ZKP commitment                         â”‚
â”‚ mpcKeyShares          Json?      Threshold key shares                   â”‚
â”‚ createdAt             DateTime                                          â”‚
â”‚ updatedAt             DateTime                                          â”‚
â”‚ lastLogin             DateTime?                                         â”‚
â”‚ emailVerified         Boolean                                           â”‚
â”‚ twoFactorEnabled      Boolean                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ 1:N
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 FILES                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                    String     @id @default(cuid())                   â”‚
â”‚ userId                String     Foreign key to User                    â”‚
â”‚ originalFilename      String     Original file name                     â”‚
â”‚ encryptedFilename     String     Storage name (.enc)                   â”‚
â”‚ mimeType              String     File MIME type                         â”‚
â”‚ fileSize              BigInt     Original size in bytes                 â”‚
â”‚ encryptedFileSize     BigInt     Encrypted size in bytes                â”‚
â”‚ storageProvider       String     "AWS_S3" | "GCP_STORAGE" | "LOCAL"     â”‚
â”‚ storageKey            String     Cloud storage path                     â”‚
â”‚ storageUrl            String?    Full storage URL                       â”‚
â”‚ encryptedDEK          String     DEK wrapped with RSA public key       â”‚
â”‚ encryptedDEKWithKMS   String?    DEK additionally wrapped with KMS     â”‚
â”‚ hmacSignature         String     HMAC-SHA512 for integrity             â”‚
â”‚ merkleRoot            String?    Merkle tree root hash                  â”‚
â”‚ encryptionAlgorithm   String     "AES-256-GCM"                         â”‚
â”‚ keyWrapAlgorithm      String     "RSA-OAEP-4096"                       â”‚
â”‚ iv                    String     Initialization vector (hex)           â”‚
â”‚ authTag               String     GCM authentication tag                 â”‚
â”‚ abePolicy             String?    Attribute-based policy                 â”‚
â”‚ fheIndexed            Boolean    Has FHE search index                   â”‚
â”‚ oramPosition          Int?       ORAM tree position                     â”‚
â”‚ uploadedAt            DateTime                                          â”‚
â”‚ lastAccessedAt        DateTime                                          â”‚
â”‚ deletedAt             DateTime?  Soft delete timestamp                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ 1:N
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             SHARED_FILES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                    String     @id                                    â”‚
â”‚ fileId                String     Foreign key to File                    â”‚
â”‚ sharedByUserId        String     Owner                                  â”‚
â”‚ sharedWithUserId      String     Recipient                              â”‚
â”‚ reEncryptionKey       String     Proxy re-encryption key               â”‚
â”‚ accessPolicy          String?    Access constraints (JSON)              â”‚
â”‚ canDownload           Boolean                                           â”‚
â”‚ canReshare            Boolean                                           â”‚
â”‚ expiresAt             DateTime?                                         â”‚
â”‚ sharedAt              DateTime                                          â”‚
â”‚ revokedAt             DateTime?                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AUDIT_LOGS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                    String     @id                                    â”‚
â”‚ userId                String?    Acting user                            â”‚
â”‚ fileId                String?    Affected file                          â”‚
â”‚ action                String     "UPLOAD" | "DOWNLOAD" | "SHARE" etc.  â”‚
â”‚ ipAddress             String?                                           â”‚
â”‚ userAgent             String?                                           â”‚
â”‚ details               Json?      Additional context (encrypted)        â”‚
â”‚ signature             String     ECDSA signature of entry              â”‚
â”‚ previousHash          String?    Hash of previous log (chain)          â”‚
â”‚ merkleProof           String?    Merkle proof for verification         â”‚
â”‚ timestamp             DateTime                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            MPC_KEY_SHARES                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                    String     @id                                    â”‚
â”‚ shareIndex            Int        1, 2, 3... (Shamir index)             â”‚
â”‚ provider              String     "AWS" | "GCP" | "LOCAL" | "USER"      â”‚
â”‚ encryptedShare        String     Encrypted threshold share             â”‚
â”‚ commitment            String     Feldman VSS commitment                 â”‚
â”‚ isActive              Boolean                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ENCRYPTION_METRICS                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                    String     @id                                    â”‚
â”‚ operation             String     "AES_ENCRYPT" | "RSA_ENCRYPT" etc.    â”‚
â”‚ durationMs            Int        Operation duration                     â”‚
â”‚ fileSizeBytes         BigInt?                                           â”‚
â”‚ throughputMBps        Float?                                            â”‚
â”‚ algorithm             String                                            â”‚
â”‚ keySize               Int?                                              â”‚
â”‚ errorOccurred         Boolean                                           â”‚
â”‚ timestamp             DateTime                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ API Endpoints

### Authentication
| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/auth/register` | POST | Register new user, generate RSA keypair |
| `/api/auth/login` | POST | Authenticate, issue JWT |
| `/api/auth/logout` | POST | Clear session |
| `/api/auth/me` | GET | Get current user info |

### File Operations
| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/files/upload` | POST | Upload encrypted file to S3 |
| `/api/files/download` | GET | Download and return encrypted data |
| `/api/files/list` | GET | List user's files |
| `/api/files/delete` | DELETE | Soft delete file |

### Sharing
| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/share/create` | POST | Create share with proxy re-encryption |
| `/api/share/revoke` | POST | Revoke shared access |

### Analytics
| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/metrics` | GET | Get encryption performance metrics |
| `/api/audit` | GET | Get audit log entries |

---

## ğŸ“ Project Structure

```
cryptovault-enterprise/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/                   # Authentication routes
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â””â”€â”€ register/
â”‚   â”œâ”€â”€ (dashboard)/              # Protected dashboard
â”‚   â”‚   â”œâ”€â”€ dashboard/            # Main dashboard
â”‚   â”‚   â”œâ”€â”€ files/                # File management
â”‚   â”‚   â”œâ”€â”€ upload/               # File upload
â”‚   â”‚   â”œâ”€â”€ keys/                 # Key management
â”‚   â”‚   â”œâ”€â”€ share/                # File sharing
â”‚   â”‚   â”œâ”€â”€ analytics/            # Metrics & analytics
â”‚   â”‚   â”œâ”€â”€ security/             # Security settings
â”‚   â”‚   â”œâ”€â”€ crypto-lab/           # Crypto demos
â”‚   â”‚   â””â”€â”€ visual-demo/          # Visual demonstrations
â”‚   â”œâ”€â”€ api/                      # API routes
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ files/
â”‚   â”‚   â”œâ”€â”€ share/
â”‚   â”‚   â”œâ”€â”€ audit/
â”‚   â”‚   â”œâ”€â”€ metrics/
â”‚   â”‚   â””â”€â”€ users/
â”‚   â”œâ”€â”€ demo/                     # Public demo mode
â”‚   â””â”€â”€ test-crypto/              # Crypto testing
â”‚
â”œâ”€â”€ components/                   # React components
â”‚   â”œâ”€â”€ ui/                       # Shadcn/UI components
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ files/
â”‚   â”œâ”€â”€ layout/
â”‚   â””â”€â”€ share/
â”‚
â”œâ”€â”€ lib/                          # Core libraries
â”‚   â”œâ”€â”€ auth/                     # JWT handling
â”‚   â”œâ”€â”€ aws/                      # AWS S3/KMS clients
â”‚   â”œâ”€â”€ crypto/                   # ğŸ” Cryptographic modules
â”‚   â”‚   â”œâ”€â”€ aes.ts
â”‚   â”‚   â”œâ”€â”€ rsa.ts
â”‚   â”‚   â”œâ”€â”€ envelope-encryption.ts
â”‚   â”‚   â”œâ”€â”€ ecdsa.ts
â”‚   â”‚   â”œâ”€â”€ diffie-hellman.ts
â”‚   â”‚   â”œâ”€â”€ hashing.ts
â”‚   â”‚   â”œâ”€â”€ kerberos.ts
â”‚   â”‚   â”œâ”€â”€ x509.ts
â”‚   â”‚   â”œâ”€â”€ post-quantum/
â”‚   â”‚   â”œâ”€â”€ zkp/
â”‚   â”‚   â”œâ”€â”€ mpc/
â”‚   â”‚   â”œâ”€â”€ abe/
â”‚   â”‚   â”œâ”€â”€ fhe/
â”‚   â”‚   â”œâ”€â”€ oram/
â”‚   â”‚   â””â”€â”€ proxy-re-encryption/
â”‚   â”œâ”€â”€ db/                       # Prisma client
â”‚   â”œâ”€â”€ storage/                  # Storage providers
â”‚   â””â”€â”€ utils/                    # Utilities
â”‚
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma             # Database schema
â”‚
â”œâ”€â”€ .env.example                  # Environment template
â”œâ”€â”€ package.json
â”œâ”€â”€ tailwind.config.ts
â””â”€â”€ tsconfig.json
```

---

## ğŸš€ Getting Started

### Prerequisites

- **Node.js** 18.17 or later
- **PostgreSQL** database
- **AWS Account** with S3 bucket and KMS key (optional for demo)

### Installation

```bash
# Clone the repository
git clone <repository-url>
cd cryptovault-enterprise

# Install dependencies
npm install

# Generate Prisma client
npm run db:generate

# Set up environment variables
cp .env.example .env.local
# Edit .env.local with your configuration

# Push database schema
npm run db:push

# Start development server
npm run dev
```

### Environment Variables

```env
# Database
DATABASE_URL="postgresql://user:password@localhost:5432/cryptovault"

# JWT Secret
JWT_SECRET="your-256-bit-secret-key"

# AWS Configuration
AWS_REGION="ap-south-1"
AWS_ACCESS_KEY_ID="your-access-key"
AWS_SECRET_ACCESS_KEY="your-secret-key"
AWS_S3_BUCKET="your-bucket-name"
AWS_KMS_KEY_ARN="arn:aws:kms:region:account:key/id"

# GCP Configuration (Optional)
GCP_PROJECT_ID="your-project"
GCP_BUCKET_NAME="your-backup-bucket"

# Feature Flags
ENABLE_POST_QUANTUM="true"
ENABLE_FHE="false"
```

---

## ğŸ® Demo Mode

The application includes a **demo mode** for testing without authentication:

1. Visit the homepage at `/`
2. Click "Try Demo" button
3. Explore the full encryption workflow:
   - Upload files (encrypted client-side)
   - Download and decrypt files
   - View encryption metrics
   - Explore crypto lab demonstrations

Demo mode uses:
- In-memory storage (localStorage fallback)
- Pre-generated demo RSA keypair
- Raw DEK storage (skips RSA wrapping for simplicity)

---

## ğŸ”® Future Roadmap

### Planned Features
- [ ] **Threshold Signatures** - Multi-party signing for critical operations
- [ ] **Hardware Security Module (HSM)** - CloudHSM integration
- [ ] **Secure Enclaves** - Intel SGX/AMD SEV support
- [ ] **Decentralized Storage** - IPFS/Filecoin integration
- [ ] **Smart Contract Audit Trail** - Ethereum-based logging
- [ ] **Mobile Applications** - iOS/Android clients
- [ ] **Browser Extensions** - Chrome/Firefox integration

### Research Areas
- [ ] **Lattice-Based PRE** - Post-quantum proxy re-encryption
- [ ] **Verifiable Delay Functions** - Time-locked encryption
- [ ] **Functional Encryption** - Compute on encrypted data
- [ ] **Searchable Symmetric Encryption** - Efficient encrypted search

---

## ğŸ“š References

### Cryptographic Standards
- [NIST SP 800-38D](https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf) - AES-GCM Mode
- [RFC 8017](https://tools.ietf.org/html/rfc8017) - RSA-OAEP
- [NIST FIPS 186-5](https://csrc.nist.gov/publications/detail/fips/186/5/final) - ECDSA
- [RFC 3526](https://tools.ietf.org/html/rfc3526) - Diffie-Hellman Groups
- [CRYSTALS-Kyber](https://pq-crystals.org/kyber/) - Post-Quantum KEM

### Research Papers
- Shamir, A. (1979). "How to Share a Secret" - Secret Sharing
- Schnorr, C.P. (1991). "Efficient Signature Generation" - ZKP Protocol
- Stefanov, E. et al. (2013). "Path ORAM" - Oblivious RAM
- Bethencourt, J. et al. (2007). "CP-ABE" - Attribute-Based Encryption
- Bennett, C.H. & Brassard, G. (1984). "BB84" - Quantum Cryptography

---

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## ğŸ™ Acknowledgments

- **Web Crypto API** - W3C standard for browser cryptography
- **@noble/curves** - High-quality elliptic curve implementations
- **Prisma** - Type-safe database access
- **Shadcn/UI** - Beautiful React components

---

<div align="center">

**Built with â¤ï¸ and ğŸ”**

*"In cryptography we trust"*

</div>
